/*
 * Copyright (c), Yanir Calisar (ycalisar at overstack.io)
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this code and associated documentation files, to deal in the code without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the code.
 * The user assumes responsibility for determining appropriate use of the code, for consequences of its use, and for checking functionality against other reliable sources.
 * We suggest citation in publications as with any code developement work. No warrantee is given.
 * Please help improve the code by sending suggestions or new code back.
 */


!function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(e,r){for(var t=r||0,o=this.length;t<o;t++)if(this[t]===e)return t;return-1});var e={cookieNameFirstTouchPrefix:"__ft_",cookieNamePrefix:"__lt_",utmParams:["utm_source","utm_medium","utm_campaign","utm_term","utm_content"],cookieExpiryDays:365,isFirstTouch:null},r=function(){var e,r,t="top_level_domain=cookie",o=document.location.hostname.split(".");for(e=o.length-1;e>=0;e--)if(r=o.slice(e).join("."),document.cookie=t+";domain=."+r+";",document.cookie.indexOf(t)>-1)return document.cookie=t.split("=")[0]+"=;domain=."+r+";expires=Thu, 01 Jan 1970 00:00:01 GMT;",r;return document.location.hostname},t=function(){if(null!=e.isFirstTouch)return e.isFirstTouch;var r=-1===document.cookie.indexOf(e.cookieNameFirstTouchPrefix);return console.log("first touch: "+r),e.isFirstTouch=r,r},o=function(){var e="__utm_tracking_session",r=void 0===i.read(e);return i.create(e,!0,1/48),r},i={create:function(e,t,o){if(o){var i=new Date;i.setTime(i.getTime()+24*o*60*60*1e3);var n="; expires="+i.toGMTString()}else n="";var a=e+"="+t+n+";domain=."+r()+";  path=/";document.cookie=a},writeCookieOnce:function(r,o){t()&&this.create(e.cookieNameFirstTouchPrefix+r,o,e.cookieExpiryDays),this.create(e.cookieNamePrefix+r,o,e.cookieExpiryDays)},read:function(e){for(var r=e+"=",t=document.cookie.split(";"),o=0;o<t.length;o++){for(var i=t[o];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(r))return i.substring(r.length,i.length)}},erase:function(e){this.createCookie(e,"",-1)}};({getParameterByName:function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.search);return null==r?"":decodeURIComponent(r[1].replace(/\+/g," "))},utmPresentInUrl:function(){for(var r=0;r<e.utmParams.length;r++){var t=e.utmParams[r],o=this.getParameterByName(t);if(""!==o&&void 0!==o)return!0}return!1},writeUtmCookieFromParams:function(){if(this.utmPresentInUrl())for(var r=0;r<e.utmParams.length;r++){var t=e.utmParams[r],o=this.getParameterByName(t);i.writeCookieOnce(t,o)}},writeReferrer:function(){var e=document.referrer,r="referrer";e&&""!==e&&void 0!==e&&-1===e.indexOf(document.location.host)?(console.log(e),i.writeCookieOnce(r,e)):i.writeCookieOnce(r,"direct")},storeParamsInCookies:function(){o()&&(this.writeUtmCookieFromParams(),this.writeReferrer())}}).storeParamsInCookies()}();