/*
 * Copyright (c), Yanir Calisar (ycalisar at overstack.io)
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this code and associated documentation files, to deal in the code without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the code.
 * The user assumes responsibility for determining appropriate use of the code, for consequences of its use, and for checking functionality against other reliable sources.
 * We suggest citation in publications as with any code developement work. No warrantee is given.
 * Please help improve the code by sending suggestions or new code back.
 */

(function(){var a='__mt_attribution',d={topDomain:function(){var g,j,k='top_level_domain=cookie',l=document.location.hostname.split('.');for(g=l.length-1;0<=g;g--)if(j=l.slice(g).join('.'),document.cookie=k+';domain=.'+j+';',-1<document.cookie.indexOf(k))return document.cookie=k.split('=')[0]+'=;domain=.'+j+';expires=Thu, 01 Jan 1970 00:00:01 GMT;',j;return document.location.hostname},create:function(g,j,k){var l=new Date;l.setTime(l.getTime()+1e3*(60*k));var m='; expires='+l.toGMTString();document.cookie=g+'='+j+m+';domain=.'+d.topDomain()+';  path=/'},read:function(g){for(var m,j=g+'=',k=document.cookie.split(';'),l=0;l<k.length;l++){for(m=k[l];' '==m.charAt(0);)m=m.substring(1,m.length);if(0==m.indexOf(j))return m.substring(j.length,m.length)}}},e={cookieName:'__mt_attr_session',isNew:function(){return d.read(e.cookieName)?(d.create(e.cookieName,'true',30),!1):(d.create(e.cookieName,'true',30),console.log('new session'),!0)},hasUtm:function(){return-1<location.search.indexOf('utm_')},hasReferrer:function(){return 0<document.referrer.length&&-1===document.referrer.indexOf(d.topDomain())}},f={params:{utm_source:'U',utm_medium:'M',utm_campaign:'N',utm_term:'T',utm_content:'C'},getParameterByName:function(g){g=g.replace(/[\[]/,'\\[').replace(/[\]]/,'\\]');var j='[\\?&]'+g+'=([^&#]*)',k=new RegExp(j),l=k.exec(window.location.search);return null==l?'':decodeURIComponent(l[1].replace(/\+/g,' '))},isTouchpoint:function(){return e.hasUtm()||e.hasReferrer()},objectize:function(){var g='TS='+Date.now();for(var j in e.hasReferrer()&&(g+='&R='+document.referrer),this.params){var k=this.getParameterByName(j);console.log(j+' -> '+k),0<k.length&&(console.log('>>>'+j+' -> '+k),g+='&'+this.params[j]+'='+k)}return console.log(g),g},touchpoint:function(){var g=this.objectize(),j=d.read(a),k=j?j+'::'+g:g;d.create(a,k,1051200)}};e.isNew()&&f.isTouchpoint()&&f.touchpoint()})();